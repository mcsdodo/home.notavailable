sonos_say_from_select_input:
  alias: Say to Sonos from select input
  sequence:
  - service: script.sonos_say_blue
    data:
      entity_id: media_player.living_room
      message: '{{ states(''input_select.sonos_tts_dropdown'') }}'
sonos_say_blue:
  alias: Say to Sonos
  use_blueprint:
    path: Talvish/sonos_say.yaml
    input:
      tts_language: sk
  mode: parallel
  icon: mdi:alarm-light
sonos_say:
  alias: Say to sonos from input
  sequence:
  - service: script.sonos_say_blue
    data_template:
      volume_level: '{{ volume }}'
      entity_id: '{{ sonos_entity }}'
      message: '{{ message }}'
try_close_garage:
  alias: Try close garage
  sequence:
  - repeat:
      sequence:
      - action: switch.turn_on
        target:
          entity_id: switch.shelly1g3_garazove_dvere
        data: {}
      - delay:
          seconds: 20
      while:
      - condition: state
        entity_id: binary_sensor.shelly1g3_garazove_dvere_input
        state: 'on'
        alias: Garaz je otvorena
      - condition: template
        value_template: '{{ (repeat.index < 3)}}'
        alias: repeat index < 3
  mode: single
  icon: mdi:garage-variant-lock
try_open_garage:
  alias: Try open garage
  sequence:
  - repeat:
      sequence:
      - service: rest_command.garage_opener
        data: {}
      - delay:
          seconds: 20
      while:
      - condition: template
        value_template: '{{ (is_state(''sensor.garage_is_opened_template'', ''False'')
          and repeat.index < 3)}}'
  mode: single
  icon: mdi:garage-open-variant
rolling_decrease_counter:
  alias: Rolling decrease counter
  sequence:
  - choose:
    - conditions:
      - condition: template
        value_template: '{{ states.counter.detska_scene_toggle_counter.attributes.minimum
          == int(states(''counter.detska_scene_toggle_counter'')) }}'
        alias: value==minimum
      sequence:
      - service: counter.set_value
        data:
          value: '{{ states.counter.detska_scene_toggle_counter.attributes.maximum
            }}'
        target:
          entity_id: counter.detska_scene_toggle_counter
    default:
    - service: counter.decrement
      data: {}
      target:
        entity_id: counter.detska_scene_toggle_counter
  mode: single
rolling_increase_counter:
  alias: Rolling increase counter
  sequence:
  - choose:
    - conditions:
      - condition: template
        value_template: '{{ states.counter.detska_scene_toggle_counter.attributes.maximum
          == int(states(''counter.detska_scene_toggle_counter'')) }}'
        alias: value==maximum
      sequence:
      - service: counter.set_value
        data:
          value: '{{ states.counter.detska_scene_toggle_counter.attributes.minimum
            }}'
        target:
          entity_id: counter.detska_scene_toggle_counter
    default:
    - service: counter.increment
      data: {}
      target:
        entity_id: counter.detska_scene_toggle_counter
  mode: single
toggle_lock:
  alias: Cycle lock
  fields:
    lock_entity_id:
      description: Lock Entity ID
      example: lock.front_door
      required: true
      selector:
        entity:
          domain: lock
  sequence:
  - choose:
    - conditions:
      - condition: template
        value_template: '{{ is_state(lock_entity_id, "locked") }}'
      sequence:
      - data: {}
        target:
          entity_id: '{{ lock_entity_id }}'
        action: lock.unlock
      - delay:
          hours: 0
          minutes: 0
          seconds: 1
          milliseconds: 0
    default:
    - data: {}
      target:
        entity_id: '{{ lock_entity_id }}'
      action: lock.lock
  mode: single
  icon: mdi:lock-clock
  description: ''
toggle_switch:
  fields:
    switch_entity_id:
      selector:
        entity:
          domain: switch
      description: Switch entity id
      required: true
    delay:
      selector:
        duration: {}
      default:
        hours: 0
        minutes: 0
        seconds: 5
  mode: single
  sequence:
  - action: switch.toggle
    metadata: {}
    data: {}
    target:
      entity_id: '{{ switch_entity_id }}'
  - delay: '{{ delay }}'
  - action: switch.toggle
    metadata: {}
    target:
      entity_id: '{{ switch_entity_id }}'
  alias: Cycle switch
  description: ''
  icon: mdi:light-switch-off
set_flexit_fan_setpoints:
  sequence:
  - action: number.set_value
    metadata:
      '[object Object]':
    data:
      value: '{{ fan_setpoint }}'
    target:
      entity_id: number.flexit_nordic_home_extract_fan_setpoint
  - action: number.set_value
    metadata: {}
    data:
      value: '{{ fan_setpoint }}'
    target:
      entity_id: number.flexit_nordic_home_supply_fan_setpoint
  fields:
    fan_setpoint:
      selector:
        number:
          min: 1
          max: 100
          step: 1
      default: 60
  alias: Set flexit fan setpoints
  description: ''
  icon: mdi:fan
unlock_door_face_recognition:
  alias: Unlock door face recognition
  mode: single
  sequence:
  - action: dahua.vto_open_door
    target:
      entity_id: camera.vratnik_main
    data:
      door_id: 1
  - action: persistent_notification.create
    data:
      title: Dvere boli otvorenÃ© (Event correlation)
      message: ''
  - action: input_text.set_value
    target:
      entity_id: input_text.frigate_face_id
    data:
      value: ''
  - action: input_text.set_value
    target:
      entity_id: input_text.frigate_zone_id
    data:
      value: ''
  - delay:
      seconds: 5
  description: ''
