services:
  emby:
    image: emby/embyserver
    container_name: embyserver
    runtime: nvidia # Expose NVIDIA GPUs
    # network_mode: host # Enable DLNA and Wake-on-Lan
    environment:
      - TZ=Europe/Bratislava
      - GIDLIST=44,993 # A comma-separated list of additional GIDs to run emby as (default: 2)
    volumes:
      - /root/emby/programdata:/config # Configuration directory
      - /mnt/media/tvshows:/mnt/tvshows # Media directory
      - /mnt/media/movies:/mnt/movies # Media directory
    ports:
      - 8099:8096 # HTTP port
      - 8920:8920 # HTTPS port
    devices:
      - /dev/dri:/dev/dri # VAAPI/NVDEC/NVENC render nodes
    restart: on-failure
    labels:
      kuma.__docker: ""
      autoheal: true
      caddy: http://emby.lan
      caddy.reverse_proxy: "{{upstreams 8096}}"
    networks:
      - arr_default
      - caddy
networks:
  arr_default:
    external: true      
  caddy:
    external: true